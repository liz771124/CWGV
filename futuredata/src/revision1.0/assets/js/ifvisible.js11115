(function(){var e,t;e=this,t=function(){var i,n,r,t,u,o,f,s,c,d,a,l,h,v,m,p;return s={},r=document,d=!1,a="active",u=!(o=6e4),m={},v="__ceGUID",p=!(n={add:function(e,t,i){return e[v]=void 0,e[v]||(e[v]="ifvisible.object.event.identifier"),m[e[v]]||(m[e[v]]={}),m[e[v]][t]||(m[e[v]][t]=[]),m[e[v]][t].push(i)},remove:function(e,t,i){var n,r,u,o,f;if(i){if(e[v]&&m[e[v]]&&m[e[v]][t])for(r=u=0,o=(f=m[e[v]][t]).length;u<o;r=++u)if((n=f[r])===i)return m[e[v]][t].splice(r,1),n}else if(e[v]&&m[e[v]]&&m[e[v]][t])return delete m[e[v]][t]},fire:function(e,t,i){var n,r,u,o,f;if(e[v]&&m[e[v]]&&m[e[v]][t]){for(f=[],r=0,u=(o=m[e[v]][t]).length;r<u;r++)n=o[r],f.push(n(i||{}));return f}}}),i=function(e,t,i){return(p=p||(e.addEventListener?function(e,t,i){return e.addEventListener(t,i,!1)}:e.attachEvent?function(e,t,i){return e.attachEvent("on"+t,i,!1)}:function(e,t,i){return e["on"+t]=i}))(e,t,i)},f=function(){var e,t,i,n;for(n=3,i=r.createElement("div"),e=i.getElementsByTagName("i"),t=function(){return i.innerHTML="\x3c!--[if gt IE "+ ++n+"]><i></i><![endif]--\x3e",e[0]};t(););return 4<n?n:void 0}(),t=!1,(h=void 0)!==r.hidden?(t="hidden",h="visibilitychange"):void 0!==r.mozHidden?(t="mozHidden",h="mozvisibilitychange"):void 0!==r.msHidden?(t="msHidden",h="msvisibilitychange"):void 0!==r.webkitHidden&&(t="webkitHidden",h="webkitvisibilitychange"),l=function(){var e,t;return e=!1,(t=function(){return clearTimeout(e),"active"!==a&&s.wakeup(),u=+new Date,e=setTimeout(function(){if("active"===a)return s.idle()},o)})(),i(r,"mousemove",t),i(r,"keyup",t),i(window,"scroll",t),s.focus(t),s.wakeup(t)},c=function(){var e;return!!d||(!1===t?(e="blur",f<9&&(e="focusout"),i(window,e,function(){return s.blur()}),i(window,"focus",function(){return s.focus()})):i(r,h,function(){return r[t]?s.blur():s.focus()},!1),d=!0,l())},s={setIdleDuration:function(e){return o=1e3*e},getIdleDuration:function(){return o},getIdleInfo:function(){var e,t;return e=+new Date,t={},"idle"===a?(t.isIdle=!0,t.idleFor=e-u,t.timeLeft=0,t.timeLeftPer=100):(t.isIdle=!1,t.idleFor=e-u,t.timeLeft=u+o-e,t.timeLeftPer=(100-100*t.timeLeft/o).toFixed(2)),t},focus:function(e){return"function"==typeof e?this.on("focus",e):(a="active",n.fire(this,"focus"),n.fire(this,"wakeup"),n.fire(this,"statusChanged",{status:a})),this},blur:function(e){return"function"==typeof e?this.on("blur",e):(a="hidden",n.fire(this,"blur"),n.fire(this,"idle"),n.fire(this,"statusChanged",{status:a})),this},idle:function(e){return"function"==typeof e?this.on("idle",e):(a="idle",n.fire(this,"idle"),n.fire(this,"statusChanged",{status:a})),this},wakeup:function(e){return"function"==typeof e?this.on("wakeup",e):(a="active",n.fire(this,"wakeup"),n.fire(this,"statusChanged",{status:a})),this},on:function(e,t){return c(),n.add(this,e,t),this},off:function(e,t){return c(),n.remove(this,e,t),this},onEvery:function(e,t){var i,n;return c(),i=!1,t&&(n=setInterval(function(){if("active"===a&&!1===i)return t()},1e3*e)),{stop:function(){return clearInterval(n)},pause:function(){return i=!0},resume:function(){return i=!1},code:n,callback:t}},now:function(e){return c(),a===(e||"active")}}},"function"==typeof define&&define.amd?define(function(){return t()}):"object"==typeof exports?module.exports=t():e.ifvisible=t()}).call(this);